<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°—Ç—É–¥–≤–æ—Ä–∫ - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" th:href="@{css/style.css}" href="../static/css/style.css">
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <script>
        htmx.config.historyEnabled = false;
    </script>
    <style>
        /* –û–ë–©–ò–ï –°–¢–ò–õ–ò –î–õ–Ø –§–û–†–ú–´ */
        
        
        /* –ê–ù–ò–ú–ê–¶–ò–Ø –ü–û–Ø–í–õ–ï–ù–ò–Ø –ò–ù–î–ò–ö–ê–¢–û–†–ê */
        @keyframes slideInDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideOutUp {
            from {
                opacity: 1;
                transform: translateY(0);
            }
            to {
                opacity: 0;
                transform: translateY(-10px);
            }
        }
        
        .password-strength-container {
            margin-top: 15px;
            padding: 20px;
            background: linear-gradient(135deg, #f8fafd 0%, #f1f5f9 100%);
            border-radius: 16px;
            border: 2px solid #e9edf3;
            animation: slideInDown 0.3s ease-out forwards;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .password-strength-container.hiding {
            animation: slideOutUp 0.3s ease-out forwards;
        }
        
        /* –ò–ù–î–ò–ö–ê–¢–û–† –ó–ê–ì–†–£–ó–ö–ò */
        .password-loading {
            display: flex;
            align-items: center;
            gap: 15px;
            color: #64748b;
            font-size: 15px;
        }
        
        .loading-spinner {
            width: 24px;
            height: 24px;
            border: 3px solid #e2e8f0;
            border-top: 3px solid #4a6cf7;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .loading-text {
            font-weight: 500;
        }
        
        /* –ö–ê–†–¢–û–ß–ö–ê –†–ï–ó–£–õ–¨–¢–ê–¢–ê */
        .strength-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.06);
        }
        
        .strength-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .strength-title {
            font-size: 16px;
            font-weight: 600;
            color: #2c3e50;
            margin: 0;
        }
        
        .strength-badge {
            padding: 8px 20px;
            border-radius: 25px;
            color: white !important;
            font-size: 14px;
            font-weight: 600;
            letter-spacing: 0.5px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transition: transform 0.2s ease;
        }
        
        .strength-badge:hover {
            transform: translateY(-2px);
        }
        
        .strength-badge.weak {
            background: linear-gradient(135deg, #ff6b6b 0%, #ff4757 100%);
        }
        
        .strength-badge.medium {
            background: linear-gradient(135deg, #ffa502 0%, #ff7f00 100%);
        }
        
        .strength-badge.strong {
            background: linear-gradient(135deg, #2ed573 0%, #1dd1a1 100%);
        }
        
        /* –ü–†–û–ì–†–ï–°–° –ë–ê–† */
        .strength-meter {
            margin: 25px 0;
        }
        
        .strength-bar {
            height: 10px;
            background: #edf2f7;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }
        
        .strength-progress {
            height: 100%;
            width: 0%;
            transition: width 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);
            border-radius: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .strength-progress::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                transparent 0%, 
                rgba(255, 255, 255, 0.4) 50%, 
                transparent 100%);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .strength-progress.weak {
            background: linear-gradient(90deg, #ff6b6b 0%, #ff4757 100%);
        }
        
        .strength-progress.medium {
            background: linear-gradient(90deg, #ffa502 0%, #ff7f00 100%);
        }
        
        .strength-progress.strong {
            background: linear-gradient(90deg, #2ed573 0%, #1dd1a1 100%);
        }
        
        .strength-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 13px;
            font-weight: 500;
        }
        
        .strength-label {
            padding: 4px 10px;
            border-radius: 6px;
            transition: all 0.3s ease;
        }
        
        .strength-label.weak { 
            color: #ff4757;
            background: rgba(255, 71, 87, 0.1);
        }
        
        .strength-label.medium { 
            color: #ff7f00;
            background: rgba(255, 127, 0, 0.1);
        }
        
        .strength-label.strong { 
            color: #1dd1a1;
            background: rgba(29, 209, 161, 0.1);
        }
        
        .strength-label.active {
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        /* –°–¢–ê–¢–ò–°–¢–ò–ö–ê */
        .strength-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #edf2f7;
        }
        
        .stat-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 12px;
            background: #f8fafc;
            border-radius: 10px;
            transition: all 0.3s ease;
        }
        
        .stat-item:hover {
            background: #f1f5f9;
            transform: translateY(-2px);
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #4a6cf7;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 12px;
            color: #64748b;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        /* –ü–†–û–í–ï–†–ö–ê –°–û–í–ü–ê–î–ï–ù–ò–Ø –ü–ê–†–û–õ–ï–ô */
        .password-match {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 15px;
            padding: 12px 16px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s ease;
            animation: slideInDown 0.3s ease;
        }
        
        .password-match.hiding {
            animation: slideOutUp 0.3s ease forwards;
        }
        
        .password-match.valid {
            background: rgba(29, 209, 161, 0.1);
            color: #1dd1a1;
        }
        
        .password-match.invalid {
            background: rgba(255, 71, 87, 0.1);
            color: #ff4757;
        }
        
        /* –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò */
        .strength-recommendations {
            margin-top: 20px;
            padding: 16px;
            background: #fff9db;
            border-radius: 12px;
            border-left: 4px solid #ffd43b;
            animation: slideInDown 0.3s ease;
        }
        
        .recommendations-title {
            font-size: 14px;
            font-weight: 600;
            color: #e67700;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .recommendations-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .recommendations-list li {
            font-size: 13px;
            color: #5c3c00;
            margin-bottom: 6px;
            padding-left: 20px;
            position: relative;
        }
        
        .recommendations-list li::before {
            content: '‚Ä¢';
            position: absolute;
            left: 0;
            color: #ffa94d;
            font-size: 18px;
        }
        
        /* –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ */
        @media (max-width: 768px) {
            .auth-container {
                margin: 20px;
                padding: 25px;
            }
            
            .strength-stats {
                grid-template-columns: 1fr;
            }
            
            .strength-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }
        
        /* –ê–ù–ò–ú–ê–¶–ò–Ø –î–õ–Ø –ö–ù–û–ü–û–ö */
        .auth-button, .register-button {
            transition: all 0.3s ease;
            transform-style: preserve-3d;
        }
        
        .auth-button:hover, .register-button:hover {
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }
    </style>
</head>

<body>
    <header>
        <div class="container">
            <div class="header-top">
                <div class="logo">
                    <a th:href="@{/sign-in}" href="/" class="logo-link">
                        <div class="logo-wrapper">
                            <img th:src="@{/images/studwork.png}" src="../static/images/studwork.png" alt="–°—Ç—É–¥–í–æ—Ä–∫"
                                class="logo-image">
                        </div>
                        <span>–°—Ç—É–¥–≤–æ—Ä–∫</span>
                    </a>
                </div>
            </div>
        </div>
    </header>
    
    <main class="main-content">
        <div class="auth-container">
            <h2 class="auth-title">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
            <form class="auth-form" th:action="@{/sign-up}" th:object="${signUpDto}" method="post">
                <input type="hidden" name="_csrf" th:value="${_csrf.token}"/>
                
                <!-- –û–°–ù–û–í–ù–´–ï –ü–û–õ–Ø -->
                <div class="form-group">
                    <label for="email">–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞</label>
                    <input type="email" name="username" th:field="*{userDto.email}" id="email"
                        placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à email" required>
                    <i class="fas fa-envelope"></i>
                </div>
                
                <!-- –ü–û–õ–ï –ü–ê–†–û–õ–Ø –° –ò–ù–î–ò–ö–ê–¢–û–†–û–ú -->
                <div class="form-group">
                    <label for="password">
                        –ü–∞—Ä–æ–ª—å
                    </label>
                    <div class="password-wrapper">
                        <input type="password" 
                               th:field="*{userDto.password}" 
                               id="password" 
                               placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–¥–µ–∂–Ω—ã–π –ø–∞—Ä–æ–ª—å" 
                               required
                               autocomplete="new-password">
                        <i class="fas fa-lock"></i>
                        <button type="button" class="password-toggle" data-target="password">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    
                    <!-- –ò–ù–î–ò–ö–ê–¢–û–† –°–ò–õ–´ –ü–ê–†–û–õ–Ø -->
                    <div id="password-strength-container" class="password-strength-container" style="display: none;">
                        <div id="password-loading" class="password-loading" style="display: none;">
                            <div class="loading-spinner"></div>
                            <span class="loading-text">–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–ª–æ–∂–Ω–æ—Å—Ç—å –ø–∞—Ä–æ–ª—è...</span>
                        </div>
                        
                        <div id="password-strength-result" class="strength-card" style="display: none;">
                            <div class="strength-header">
                                <h4 class="strength-title">–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø–∞—Ä–æ–ª—è</h4>
                                <div class="strength-badge" id="strength-badge">‚Äî</div>
                            </div>
                            
                            <div class="strength-meter">
        <div class="strength-bar">
            <div id="strength-progress" class="strength-progress"></div>
            <!-- –î–æ–±–∞–≤—å—Ç–µ —ç—Ç—É –ª–∏–Ω–∏—é -->
            <div id="strength-indicator" class="strength-indicator">
                <div class="indicator-dot"></div>
            </div>
        </div>
                                <div class="strength-labels">
                                    <span class="strength-label weak">–°–ª–∞–±–∞—è</span>
                                    <span class="strength-label medium">–°—Ä–µ–¥–Ω—è—è</span>
                                    <span class="strength-label strong">–ù–∞–¥–µ–∂–Ω–∞—è</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- –ü–û–î–¢–í–ï–†–ñ–î–ï–ù–ò–ï –ü–ê–†–û–õ–Ø -->
                <div class="form-group">
                    <label for="password2">–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å</label>
                    <div class="password-wrapper">
                        <input type="password" th:field="*{userDto.password2}" id="password2" 
                               placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –µ—â–µ —Ä–∞–∑" required>
                        <i class="fas fa-lock"></i>
                        <button type="button" class="password-toggle" data-target="password2">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    
                    <!-- –ò–ù–î–ò–ö–ê–¢–û–† –°–û–í–ü–ê–î–ï–ù–ò–Ø -->
                    <div id="password-match" class="password-match" style="display: none;">
                        <i class="fas fa-check-circle"></i>
                        <span id="match-text">–ü–∞—Ä–æ–ª–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç</span>
                    </div>
                </div>

                <!-- –û–°–¢–ê–õ–¨–ù–´–ï –ü–û–õ–Ø -->
                <div class="form-group">
                    <label for="name">–ò–º—è</label>
                    <input type="text" th:field="*{userDto.name}" id="name" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è" required>
                    <i class="fas fa-user"></i>
                </div>

                <div class="form-group">
                    <label for="surname">–§–∞–º–∏–ª–∏—è</label>
                    <input type="text" th:field="*{userDto.surname}" id="surname" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à—É —Ñ–∞–º–∏–ª–∏—é"
                        required>
                    <i class="fas fa-user"></i>
                </div>

                <div class="form-group">
                    <label for="lastName">–û—Ç—á–µ—Å—Ç–≤–æ</label>
                    <input type="text" th:field="*{userDto.lastName}" id="lastName" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –æ—Ç—á–µ—Å—Ç–≤–æ">
                    <i class="fas fa-user"></i>
                </div>

                <div class="form-group">
                    <label for="birthDate">–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
                    <input type="date" th:field="*{userDto.birthDate}" id="birth_date" required>
                    <i class="fas fa-calendar"></i>
                </div>

                <div class="form-group">
                    <label for="sex">–ü–æ–ª</label>
                    <select th:field="*{userDto.sex}" id="sex" required>
                        <option th:each="s: ${sexes}" th:value="${s}" th:text="${s.displayValue}"></option>
                    </select>
                    <i class="fas fa-venus-mars"></i>
                </div>

                <div class="form-group">
                    <label for="role">–†–æ–ª—å</label>
                    <select id="role" 
                            th:field="*{userDto.role}" 
                            required
                            hx-get="/fragments/profile-fields"
                            hx-trigger="change"
                            hx-target="#profile-fields-container"
                            hx-vals="js:{role: document.getElementById('role').value}">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–æ–ª—å</option>
                        <option th:each="r: ${roles}" th:value="${r}" th:text="${r.displayValue}"></option>
                    </select>
                    <i class="fas fa-user-tag"></i>
                </div>

                <div id="profile-fields-container"></div>

                <!-- –°–û–û–ë–©–ï–ù–ò–Ø -->
                <div th:if="${successMessage}" class="alert alert-success">
                    <i class="fas fa-check-circle"></i>
                    <span th:text="${successMessage}"></span>
                </div>

                <div th:if="${errorMessage}" class="alert alert-error">
                    <i class="fas fa-exclamation-circle"></i>
                    <span th:text="${errorMessage}"></span>
                </div>

                <button type="submit" class="auth-button">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>

                <div class="auth-links">
                    <a href="#"><i class="fas fa-shield-alt"></i> –ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
                    <a href="#"><i class="fas fa-question-circle"></i> –ü–æ–º–æ—â—å</a>
                </div>
            </form>

            <div class="divider">
                <span>–∏–ª–∏</span>
            </div>

            <p style="margin-bottom: 20px; text-align: center;">–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç?</p>
            <button class="register-button" th:onclick="'location.href=\'' + @{/sign-in} + '\''"
                onclick="window.location.href='enter.html'">
                –í–æ–π—Ç–∏
            </button>
        </div>
    </main>
    
    <footer>
        <div class="container">
            <div class="footer-content">
				<div class="footer-column">
					<h3>–°–æ–∏—Å–∫–∞—Ç–µ–ª—è–º</h3>
					<ul>
						<li><a href="#"><i class="fas fa-briefcase"></i> –í–∞–∫–∞–Ω—Å–∏–∏</a></li>
						<li><a href="#"><i class="fas fa-graduation-cap"></i> –°—Ç–∞–∂–∏—Ä–æ–≤–∫–∏</a></li>
						<li><a href="#"><i class="fas fa-file-alt"></i> –ö–∞–∫ —Å–æ—Å—Ç–∞–≤–∏—Ç—å —Ä–µ–∑—é–º–µ</a></li>
						<li><a href="#"><i class="fas fa-comments"></i> –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏—é</a></li>
					</ul>
				</div>

				<div class="footer-column">
					<h3>–†–∞–±–æ—Ç–æ–¥–∞—Ç–µ–ª—è–º</h3>
					<ul>
						<li><a href="#"><i class="fas fa-plus-circle"></i> –†–∞–∑–º–µ—â–µ–Ω–∏–µ –≤–∞–∫–∞–Ω—Å–∏–π</a></li>
						<li><a href="#"><i class="fas fa-calendar-alt"></i> –Ø—Ä–º–∞—Ä–∫–∏ –≤–∞–∫–∞–Ω—Å–∏–π</a></li>
						<li><a href="#"><i class="fas fa-handshake"></i> –°–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ —Å –≤—É–∑–æ–º</a></li>
					</ul>
				</div>

				<div class="footer-column">
					<h3>–û –ø—Ä–æ–µ–∫—Ç–µ</h3>
					<ul>
						<li><a href="#"><i class="fas fa-info-circle"></i> –û –°—Ç—É–¥–í–æ—Ä–∫</a></li>
						<li><a href="#"><i class="fas fa-phone"></i> –ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
						<li><a href="#"><i class="fas fa-life-ring"></i> –ü–æ–º–æ—â—å</a></li>
						<li><a href="#"><i class="fas fa-question-circle"></i> –í–æ–ø—Ä–æ—Å—ã –∏ –æ—Ç–≤–µ—Ç—ã</a></li>
					</ul>
				</div>

				<div class="footer-column">
					<h3>–ú—ã –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö</h3>
					<div class="social-links">
						<a href="#"><i class="fab fa-vk"></i></a>
						<a href="#"><i class="fab fa-telegram"></i></a>
						<a href="#"><i class="fab fa-youtube"></i></a>
					</div>
				</div>
			</div>

            <div class="copyright">
                ¬© 2025 –°—Ç—É–¥–í–æ—Ä–∫ - –ö–∞—Ä—å–µ—Ä–Ω—ã–π —Ü–µ–Ω—Ç—Ä. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.
            </div>
        </div>
    </footer>

    <script>
    // –ü–ï–†–ï–ú–ï–ù–ù–´–ï –ò –°–û–°–¢–û–Ø–ù–ò–ï
    let checkTimeout;
    let isChecking = false;
    let lastPassword = '';
    
    // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
    document.addEventListener('DOMContentLoaded', function() {
        const passwordInput = document.getElementById('password');
        if (!passwordInput) return;
        passwordInput.addEventListener('input', handlePasswordInput);
        
        // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
        const password2Input = document.getElementById('password2');
        if (password2Input) {
            password2Input.addEventListener('input', checkPasswordMatch);
        }
        
        
        // 3. –ö–Ω–æ–ø–∫–∏ –ø–æ–∫–∞–∑–∞/—Å–∫—Ä—ã—Ç–∏—è –ø–∞—Ä–æ–ª—è
        setupPasswordToggles();
        
        console.log('‚úÖ –§–æ—Ä–º–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
    });
    
    // –û–ë–†–ê–ë–û–¢–ß–ò–ö –í–í–û–î–ê –ü–ê–†–û–õ–Ø
    function handlePasswordInput(event) {
        const password = event.target.value;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É
        updatePasswordHint(password);
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–∞—Ä–æ–ª—å
        checkPasswordStrength(password);
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π
        checkPasswordMatch();
    }
    
    // –û–ë–ù–û–í–õ–ï–ù–ò–ï –ü–û–î–°–ö–ê–ó–ö–ò
    function updatePasswordHint(password) {
        const hint = document.getElementById('password-hint');
        if (!hint) return;
    }
    
    // –ü–†–û–í–ï–†–ö–ê –°–ò–õ–´ –ü–ê–†–û–õ–Ø
    function checkPasswordStrength(password) {
        // –î–µ–±–∞—É–Ω—Å
        clearTimeout(checkTimeout);
        
        // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –µ—Å–ª–∏ –ø–∞—Ä–æ–ª—å –ø—É—Å—Ç–æ–π
        if (!password || password.trim().length === 0) {
            hidePasswordStrength();
            lastPassword = '';
            return;
        }
        
        // –ï—Å–ª–∏ –ø–∞—Ä–æ–ª—å –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è, –≤—ã—Ö–æ–¥–∏–º
        if (password === lastPassword) return;
        lastPassword = password;
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
        showPasswordStrength();
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
        checkTimeout = setTimeout(() => {
            sendPasswordToServer(password);
        }, 600);
    }
    
    // –û–¢–ü–†–ê–í–ö–ê –ù–ê –°–ï–†–í–ï–†
    function sendPasswordToServer(password) {
        if (isChecking) return;
        
        isChecking = true;
        showLoading(true);
        
        const csrfToken = document.querySelector('input[name="_csrf"]').value;
        
        fetch('/api/password/check', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRF-TOKEN': csrfToken
            },
            body: JSON.stringify({password: password})
        })
        .then(response => {
            if (!response.ok) throw new Error('–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: ' + response.status);
            return response.json();
        })
        .then(data => {
            updatePasswordStrengthUI(data, password);
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞:', error);
            const fallbackData = getLocalPasswordStrength(password);
            updatePasswordStrengthUI(fallbackData, password);
        })
        .finally(() => {
            isChecking = false;
            showLoading(false);
        });
    }
    
    // –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê
    // –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–ê
function updatePasswordStrengthUI(data, password) {
    // –ë–µ–π–¥–∂ —Å–∏–ª—ã
    updateStrengthBadge(data);
    
    // –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä
    updateProgressBar(data);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
    updateStrengthIndicator(data);
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
    showResult();
}

// –û–ë–ù–û–í–õ–ï–ù–ò–ï –ò–ù–î–ò–ö–ê–¢–û–†–ê
function updateStrengthIndicator(data) {
    const indicator = document.getElementById('strength-indicator');
    if (!indicator) return;
    
    const strength = data.strength || 'weak';
    const score = data.score || 0;
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
    indicator.style.display = 'flex';
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ score
    const percentage = Math.min(score, 100);
    indicator.style.left = percentage + '%';
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–µ–∫—Å—Ç –≤–Ω—É—Ç—Ä–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
    const valueElement = indicator.querySelector('.indicator-value');
    if (valueElement) {
        valueElement.textContent = Math.round(score);
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–≤–µ—Ç —Ç–æ—á–∫–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
    const dotElement = indicator.querySelector('.indicator-dot');
    if (dotElement) {
        dotElement.className = 'indicator-dot ' + strength;
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–≤–µ—Ç —Ç–µ–∫—Å—Ç–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
    if (valueElement) {
        valueElement.className = 'indicator-value ' + strength;
    }
}
    
    // –û–ë–ù–û–í–õ–ï–ù–ò–ï –ë–ï–ô–î–ñ–ê
    function updateStrengthBadge(data) {
        const badge = document.getElementById('strength-badge');
        if (!badge) return;
        
        let text, className;
        
        switch(data.strength) {
            case 'strong':
                text = '–ù–∞–¥–µ–∂–Ω–∞—è';
                className = 'strong';
                break;
            case 'medium':
                text = '–°—Ä–µ–¥–Ω—è—è';
                className = 'medium';
                break;
            default:
                text = '–°–ª–∞–±–∞—è';
                className = 'weak';
        }
        
        badge.textContent = text;
        badge.className = 'strength-badge ' + className;
        
        // –ê–Ω–∏–º–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è
        badge.style.animation = 'none';
        setTimeout(() => {
            badge.style.animation = 'scaleUp 0.3s ease';
        }, 10);
    }
    
    // –û–ë–ù–û–í–õ–ï–ù–ò–ï –ü–†–û–ì–†–ï–°–° –ë–ê–†–ê
    function updateProgressBar(data) {
        const progress = document.getElementById('strength-progress');
        const score = data.score || 0;
        
        if (progress) {
            progress.className = 'strength-progress ' + data.strength;
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
            setTimeout(() => {
                progress.style.width = Math.min(score, 100) + '%';
            }, 100);
            
            // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∞–∫—Ç–∏–≤–Ω–æ–π –º–µ—Ç–∫–∏
            const labels = document.querySelectorAll('.strength-label');
            labels.forEach(label => {
                label.classList.remove('active');
                if (label.classList.contains(data.strength)) {
                    label.classList.add('active');
                }
            });
        }
    }
    
    // –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–¢–ê–¢–ò–°–¢–ò–ö–ò
    function updateStats(data, password) {
        // –ë–∞–ª–ª—ã
        const scoreEl = document.getElementById('stat-score');
        if (scoreEl) scoreEl.textContent = data.score || 0;
        
        // –î–ª–∏–Ω–∞ –ø–∞—Ä–æ–ª—è
        const lengthEl = document.getElementById('stat-length');
        if (lengthEl) lengthEl.textContent = password.length;
        
        // –†–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Å–∏–º–≤–æ–ª–æ–≤
        const varietyEl = document.getElementById('stat-variety');
        if (varietyEl) {
            const variety = calculateVariety(password);
            varietyEl.textContent = variety;
        }
        
        // –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å
        const confidenceEl = document.getElementById('stat-confidence');
        if (confidenceEl) {
            const confidence = Math.round((data.confidence || 0) * 100);
            confidenceEl.textContent = confidence + '%';
        }
    }
    
    
    
    // –ü–†–û–í–ï–†–ö–ê –°–û–í–ü–ê–î–ï–ù–ò–Ø –ü–ê–†–û–õ–ï–ô
    function checkPasswordMatch() {
    const password1 = document.getElementById('password').value;
    const password2 = document.getElementById('password2').value;
    const matchEl = document.getElementById('password-match');
    const textEl = document.getElementById('match-text');
    
    if (!matchEl || !textEl) return;
    
    // –°–∫—Ä—ã–≤–∞–µ–º –µ—Å–ª–∏ –ø–æ–ª—è –ø—É—Å—Ç—ã–µ
    if (!password1 || !password2) {
        hideElement(matchEl, 'password-match');
        return;
    }
    
    const match = password1 === password2;
    
    if (!match) {
        // –ü–∞—Ä–æ–ª–∏ –ù–ï —Å–æ–≤–ø–∞–¥–∞—é—Ç - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—à–∏–±–∫—É
        matchEl.className = 'alert alert-error';
        textEl.textContent = '–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç';
        matchEl.innerHTML = '<i class="fas fa-exclamation-circle"></i> ' + textEl.outerHTML;
        showElement(matchEl, 'password-match');
    } else {
        // –ü–∞—Ä–æ–ª–∏ —Å–æ–≤–ø–∞–¥–∞—é—Ç - –°–ö–†–´–í–ê–ï–ú —Å–æ–æ–±—â–µ–Ω–∏–µ
        hideElement(matchEl, 'password-match');
    }
}
    
    // –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
    function setupPasswordToggles() {
        document.querySelectorAll('.password-toggle').forEach(button => {
            button.addEventListener('click', function() {
                const targetId = this.getAttribute('data-target');
                const input = document.getElementById(targetId);
                const icon = this.querySelector('i');
                
                if (input.type === 'password') {
                    input.type = 'text';
                    icon.classList.remove('fa-eye');
                    icon.classList.add('fa-eye-slash');
                } else {
                    input.type = 'password';
                    icon.classList.remove('fa-eye-slash');
                    icon.classList.add('fa-eye');
                }
            });
        });
    }
    
    function showPasswordStrength() {
        const container = document.getElementById('password-strength-container');
        if (container && container.style.display === 'none') {
            container.style.display = 'block';
            container.classList.remove('hiding');
        }
    }
    
    function hidePasswordStrength() {
        const container = document.getElementById('password-strength-container');
        if (container && container.style.display !== 'none') {
            container.classList.add('hiding');
            setTimeout(() => {
                container.style.display = 'none';
                container.classList.remove('hiding');
            }, 300);
        }
    }
    
    function showLoading(show) {
        const loading = document.getElementById('password-loading');
        const result = document.getElementById('password-strength-result');
        
        if (loading) loading.style.display = show ? 'flex' : 'none';
        if (result) result.style.display = show ? 'none' : 'block';
    }
    
    function showResult() {
        const result = document.getElementById('password-strength-result');
        if (result) result.style.display = 'block';
    }
    
    function showElement(element, baseClass) {
        if (element.style.display === 'none') {
            element.style.display = 'block';
            element.classList.remove('hiding');
        }
    }
    
    function hideElement(element, baseClass) {
        if (element.style.display !== 'none') {
            element.classList.add('hiding');
            setTimeout(() => {
                element.style.display = 'none';
                element.classList.remove('hiding');
            }, 300);
        }
    }
    
    // CSS –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ scaleUp
    const style = document.createElement('style');
    style.textContent = `
        @keyframes scaleUp {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
    `;
    document.head.appendChild(style);
    </script>
    <script>
	// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
	document.addEventListener('DOMContentLoaded', function() {
		initPasswordToggles();
		
		// –°—Ç–∏–ª–∏ –¥–ª—è –≤—ã–ø–∞–¥–∞—é—â–∏—Ö —Å–ø–∏—Å–∫–æ–≤
		const style = document.createElement('style');
		style.textContent = `
			.suggestions-list {
				position: absolute !important;
				top: 100% !important;
				left: 0 !important;
				right: 0 !important;
				background: white !important;
				border: 1px solid #ddd !important;
				border-radius: 4px !important;
				box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important;
				max-height: 132px !important;
				min-height: 44px !important;
				overflow-y: auto !important;
				z-index: 9999 !important;
				margin-top: 2px !important;
			}
			.suggestion-item {
				padding: 10px 15px !important;
				border: none !important;
				background: white !important;
				width: 100% !important;
				text-align: left !important;
				cursor: pointer !important;
				border-bottom: 1px solid #f0f0f0 !important;
				display: block !important;
				color: #333 !important;
				text-decoration: none !important;
				height: 44px !important;
				box-sizing: border-box !important;
				line-height: 24px !important;
				overflow: hidden !important;
				text-overflow: ellipsis !important;
				white-space: nowrap !important;
			}
			.suggestion-item:hover {
				background-color: #f5f5f5 !important;
			}
			.suggestion-item:last-child {
				border-bottom: none !important;
			}
		`;
		document.head.appendChild(style);
	});

	function selectSuggestion(buttonElement, inputId) {
		const input = document.getElementById(inputId);
		const code = buttonElement.getAttribute('data-code');
		const name = buttonElement.getAttribute('data-name');
		
		if (code && name) {
			input.value = `${code} - ${name}`;
		} else {
			input.value = buttonElement.textContent;
		}
		
		const suggestionsContainer = buttonElement.closest('.suggestions-list');
		if (suggestionsContainer) {
			suggestionsContainer.remove();
		}
	}

	document.addEventListener('click', function(event) {
		if (event.target.matches('.suggestion-item')) {
			const container = event.target.closest('[id$="-suggestions"]');
			let inputId;
			if (container && container.id === 'speciality-suggestions') {
				inputId = 'specialityInput';
			} else if (container && container.id === 'university-suggestions') {
				inputId = 'universityInput';
			} else {
				inputId = 'universityInput';
			}
			selectSuggestion(event.target, inputId);
		}
		
		if (!event.target.matches('.suggestion-item') && 
			!event.target.matches('input[type="text"]')) {
			const suggestions = document.querySelectorAll('.suggestions-list');
			suggestions.forEach(suggestion => suggestion.remove());
		}
	});
	</script>

	<script>
	function loadProfileFields(role) {
		console.log('Loading fields for role:', role);
		
		fetch('/fragments/profile-fields?role=' + role)
			.then(response => response.text())
			.then(html => {
				document.getElementById('profile-fields-container').innerHTML = html;
				htmx.process(document.getElementById('profile-fields-container'));
				
				// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π
				setTimeout(() => {
					initPasswordToggles();
				}, 100);
			})
			.catch(error => {
				console.error('Error:', error);
			});
	}
	</script>
    <script>
document.addEventListener('DOMContentLoaded', function() {
    console.log('üîí –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–æ–ª—è: –∑–∞–ø—Ä–µ—Ç —Ä—É—Å—Å–∫–∏—Ö –±—É–∫–≤ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º');
    
    const passwordInput = document.getElementById('password');
    if (!passwordInput) return;
    
    const strengthContainer = document.getElementById('password-strength-container');
    if (!strengthContainer) return;
    
    // === 1. –ó–ê–ü–†–ï–¢ –†–£–°–°–ö–ò–• –ë–£–ö–í ===
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞–∂–∞—Ç–∏—è –∫–ª–∞–≤–∏—à
    passwordInput.addEventListener('keydown', function(e) {
        // –†–∞–∑—Ä–µ—à–∞–µ–º —Å–ª—É–∂–µ–±–Ω—ã–µ –∫–ª–∞–≤–∏—à–∏
        if (e.ctrlKey || e.altKey || e.metaKey || 
            e.key === 'Backspace' || e.key === 'Delete' || 
            e.key === 'Tab' || e.key === 'Escape' || 
            e.key === 'ArrowLeft' || e.key === 'ArrowRight' ||
            e.key === 'Home' || e.key === 'End' ||
            e.key === 'Enter' || e.key === 'Shift') {
            return;
        }
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ —Å–∏–º–≤–æ–ª —Ä—É—Å—Å–∫–æ–π –±—É–∫–≤–æ–π
        const isRussianLetter = /[–∞-—è–ê-–Ø—ë–Å]/.test(e.key);
        if (isRussianLetter) {
            e.preventDefault();
            showRussianLetterWarning();
        }
    });

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—Å—Ç–∞–≤–∫–∏ –∏–∑ –±—É—Ñ–µ—Ä–∞ –æ–±–º–µ–Ω–∞
    passwordInput.addEventListener('paste', function(e) {
        const pastedText = (e.clipboardData || window.clipboardData).getData('text');
        
        if (/[–∞-—è–ê-–Ø—ë–Å]/.test(pastedText)) {
            e.preventDefault();
            showRussianLetterWarning();
            
            // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –æ—Ç —É–∂–µ –≤—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã—Ö —Ä—É—Å—Å–∫–∏—Ö –±—É–∫–≤
            setTimeout(() => {
                const currentValue = passwordInput.value;
                const cleanedValue = currentValue.replace(/[–∞-—è–ê-–Ø—ë–Å]/g, '');
                if (currentValue !== cleanedValue) {
                    passwordInput.value = cleanedValue;
                    // –¢—Ä–∏–≥–≥–µ—Ä–∏–º —Å–æ–±—ã—Ç–∏–µ input –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
                    passwordInput.dispatchEvent(new Event('input'));
                }
            }, 0);
        }
    });

    // === 2. –£–ü–†–ê–í–õ–ï–ù–ò–ï –ò–ù–î–ò–ö–ê–¢–û–†–û–ú –ü–ê–†–û–õ–Ø ===
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞ —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
    function hidePasswordStrength() {
        if (strengthContainer.style.display !== 'none') {
            // –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏ –∏—Å—á–µ–∑–Ω–æ–≤–µ–Ω–∏—è
            strengthContainer.classList.add('hiding');
            
            // –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏ —Å–∫—Ä—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç
            setTimeout(() => {
                strengthContainer.style.display = 'none';
                strengthContainer.classList.remove('hiding');
            }, 300); // –î–æ–ª–∂–Ω–æ —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –∞–Ω–∏–º–∞—Ü–∏–∏ –≤ CSS
        }
    }
    
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
    function showPasswordStrength() {
        if (strengthContainer.style.display === 'none') {
            strengthContainer.style.display = 'block';
            strengthContainer.classList.remove('hiding');
        }
    }
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç—É –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
    document.addEventListener('click', function(event) {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –±—ã–ª –ª–∏ –∫–ª–∏–∫ –≤–Ω—É—Ç—Ä–∏ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –ø–∞—Ä–æ–ª–µ–º
        const clickedElement = event.target;
        const isPasswordRelated = 
            clickedElement === passwordInput ||
            clickedElement.closest('.password-wrapper') ||
            clickedElement.closest('#password-strength-container') ||
            clickedElement.closest('.password-toggle');
        
        // –ï—Å–ª–∏ –∫–ª–∏–∫ –±—ã–ª –ù–ï –≤ —ç–ª–µ–º–µ–Ω—Ç–∞—Ö –ø–∞—Ä–æ–ª—è
        if (!isPasswordRelated) {
            // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª–µ –ø–∞—Ä–æ–ª—è –ø—É—Å—Ç–æ–µ
            if (!passwordInput.value || passwordInput.value.trim().length === 0) {
                hidePasswordStrength();
            }
        }
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ—Ç–µ—Ä–∏ —Ñ–æ–∫—É—Å–∞ —Å –ø–æ–ª—è –ø–∞—Ä–æ–ª—è
    passwordInput.addEventListener('blur', function() {
        // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞, —á—Ç–æ–±—ã –¥–∞—Ç—å –≤—Ä–µ–º—è –¥–ª—è –∫–ª–∏–∫–æ–≤ –≤–Ω—É—Ç—Ä–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
        setTimeout(() => {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –ª–∏ —Ñ–æ–∫—É—Å –≤–Ω—É—Ç—Ä–∏ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞
            const activeElement = document.activeElement;
            const isFocusInsideIndicator = activeElement && 
                (activeElement.closest('#password-strength-container') || 
                 activeElement.closest('.password-toggle'));
            
            // –ï—Å–ª–∏ —Ñ–æ–∫—É—Å –Ω–µ –≤ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–µ –∏ –ø–æ–ª–µ –ø–∞—Ä–æ–ª—è –ø—É—Å—Ç–æ–µ - —Å–∫—Ä—ã–≤–∞–µ–º
            if (!isFocusInsideIndicator && 
                (!passwordInput.value || passwordInput.value.trim().length === 0)) {
                hidePasswordStrength();
            }
        }, 150); // –£–≤–µ–ª–∏—á–∏–ª –∑–∞–¥–µ—Ä–∂–∫—É –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ–ª—É—á–µ–Ω–∏—è —Ñ–æ–∫—É—Å–∞ –ø–æ–ª–µ–º –ø–∞—Ä–æ–ª—è
    passwordInput.addEventListener('focus', function() {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤ –ø–æ–ª–µ –µ—Å—Ç—å —Ç–µ–∫—Å—Ç
        if (passwordInput.value && passwordInput.value.trim().length > 0) {
            showPasswordStrength();
        }
    });
    
    // –¢–∞–∫–∂–µ —Å–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–æ–ª—è –Ω–∞ –ø—É—Å—Ç–æ–π
    passwordInput.addEventListener('input', function() {
        // –ï—Å–ª–∏ –ø–æ–ª–µ —Å—Ç–∞–ª–æ –ø—É—Å—Ç—ã–º - —Å–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
        if (!passwordInput.value || passwordInput.value.trim().length === 0) {
            hidePasswordStrength();
        } else {
            // –ï—Å–ª–∏ –ø–æ—è–≤–∏–ª—Å—è —Ç–µ–∫—Å—Ç - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –ø–æ–∫–∞–∑–∞–Ω)
            showPasswordStrength();
        }
    });
    
    // === 3. –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ú–ï–•–ê–ù–ò–ó–ú–´ –°–ö–†–´–¢–ò–Ø ===
    
    // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ Escape
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && strengthContainer.style.display !== 'none') {
            hidePasswordStrength();
        }
    });
    
    // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    let scrollTimeout;
    window.addEventListener('scroll', function() {
        if (strengthContainer.style.display !== 'none') {
            clearTimeout(scrollTimeout);
            scrollTimeout = setTimeout(() => {
                hidePasswordStrength();
            }, 100);
        }
    });
    
    // === 4. –§–£–ù–ö–¶–ò–Ø –ü–û–ö–ê–ó–ê –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–Ø ===
    
    function showRussianLetterWarning() {
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ª–∏ —É–∂–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
        if (document.getElementById('russian-letter-warning')) return;
        
        // –°–æ–∑–¥–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
        const warning = document.createElement('div');
        warning.id = 'russian-letter-warning';
        warning.className = 'alert alert-error';
        warning.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 10000;
            padding: 15px 20px;
            border-radius: 8px;
            background: linear-gradient(135deg, #ff6b6b 0%, #ff4757 100%);
            color: white;
            display: flex;
            align-items: center;
            box-shadow: 0 4px 15px rgba(255, 71, 87, 0.3);
            animation: warningFadeIn 0.3s ease;
            font-weight: 500;
            max-width: 300px;
            font-family: 'Roboto', sans-serif;
        `;
        warning.innerHTML = `
            <i class="fas fa-exclamation-triangle" style="margin-right: 12px; font-size: 18px;"></i>
            <span>–ü–∞—Ä–æ–ª—å –Ω–µ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∫–∏—Ä–∏–ª–ª–∏—Ü—É</span>
        `;
        
        document.body.appendChild(warning);
        
        // –£–¥–∞–ª—è–µ–º —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
        setTimeout(() => {
            warning.style.animation = 'warningFadeOut 0.3s ease forwards';
            setTimeout(() => {
                if (warning.parentNode) {
                    warning.parentNode.removeChild(warning);
                }
            }, 300);
        }, 3000);
    }
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π
    const style = document.createElement('style');
    style.textContent = `
        @keyframes warningFadeIn {
            from { 
                opacity: 0; 
                transform: translateY(-20px) translateX(20px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0) translateX(0); 
            }
        }
        @keyframes warningFadeOut {
            from { 
                opacity: 1; 
                transform: translateY(0) translateX(0); 
            }
            to { 
                opacity: 0; 
                transform: translateY(-20px) translateX(20px); 
            }
        }
        
        /* –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∞–Ω–∏–º–∞—Ü–∏—è —Å–∫—Ä—ã—Ç–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç */
        .password-strength-container.hiding {
            animation: slideOutUp 0.3s ease-out forwards !important;
            opacity: 0;
            transform: translateY(-10px);
        }
        
        @keyframes slideOutUp {
            from {
                opacity: 1;
                transform: translateY(0);
            }
            to {
                opacity: 0;
                transform: translateY(-10px);
            }
        }
    `;
    document.head.appendChild(style);
    
    console.log('‚úÖ –ú–æ–¥—É–ª—å –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä–æ–ª—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
});
</script>
</body>
</html>